# PairTCR Web Interface

ä¸€ä¸ªç”¨äºè¿è¡ŒPairTCRæµç¨‹çš„ç°ä»£åŒ–Webç•Œé¢ï¼Œæ”¯æŒå®æ—¶æ—¥å¿—ç›‘æ§å’Œåå°ä»»åŠ¡æ‰§è¡Œã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸŒ **ç›´è§‚çš„Webç•Œé¢**: åŸºäºBootstrap 5çš„ç°ä»£åŒ–å“åº”å¼è®¾è®¡
- ğŸ”„ **å®æ—¶ç›‘æ§**: WebSocketå®æ—¶æ—¥å¿—è¾“å‡ºå’Œè¿›åº¦è·Ÿè¸ª
- ğŸš€ **åå°æ‰§è¡Œ**: ä»»åŠ¡åœ¨åå°è¿è¡Œï¼Œæ— éœ€ä¿æŒæµè§ˆå™¨çª—å£
- ğŸ“¦ **ä¸€é”®ä¸‹è½½**: è‡ªåŠ¨æ‰“åŒ…ç»“æœæ–‡ä»¶ä¸ºZIPæ ¼å¼
- ğŸ“± **ç§»åŠ¨å‹å¥½**: æ”¯æŒæ‰‹æœºå’Œå¹³æ¿è®¾å¤‡è®¿é—®
- âš™ï¸ **å‚æ•°é…ç½®**: æ”¯æŒæ‰€æœ‰PairTCRæµç¨‹å‚æ•°çš„è‡ªå®šä¹‰è®¾ç½®

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd web
pip install -r requirements.txt
```

### 2. å¯åŠ¨æœåŠ¡å™¨

```bash
python start_server.py
```

æˆ–è€…ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£ï¼š

```bash
python start_server.py --port 8080
```

### 3. è®¿é—®Webç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5000

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

1. **è¾“å…¥ç›®å½•**: è¾“å…¥åŒ…å«FASTQæ–‡ä»¶çš„ç›®å½•è·¯å¾„
2. **è®¾ç½®å‚æ•°**: é…ç½®æ–‡ä»¶å‰ç¼€ã€è¯»å–é™åˆ¶ã€çº¿ç¨‹æ•°ç­‰å‚æ•°
3. **å¯åŠ¨æµç¨‹**: ç‚¹å‡»"Start Pipeline"å¼€å§‹åˆ†æ
4. **ç›‘æ§è¿›åº¦**: å®æ—¶æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—å’Œè¿›åº¦æ¡
5. **ä¸‹è½½ç»“æœ**: æµç¨‹å®Œæˆåä¸€é”®ä¸‹è½½å‹ç¼©åŒ…

### é«˜çº§é€‰é¡¹

- **MiXCR JARè·¯å¾„**: è‡ªå®šä¹‰MiXCRè½¯ä»¶ä½ç½®
- **Cç‰ˆæœ¬åŠ é€Ÿ**: ä½¿ç”¨ç¼–è¯‘çš„Cç¨‹åºæé«˜æ€§èƒ½
- **å¼ºåˆ¶é‡å¯**: åˆ é™¤å·²æœ‰ç»“æœé‡æ–°å¼€å§‹

### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| Input Directory | FASTQæ–‡ä»¶ç›®å½• | å¿…éœ€ |
| File Prefix | æ–‡ä»¶å‰ç¼€ | TCR_TSO_18 |
| Read Limit | æœ€å¤§è¯»å–æ•°é‡ | 100,000 |
| Threads | CPUçº¿ç¨‹æ•° | 4 |
| MiXCR JAR | MiXCRç¨‹åºè·¯å¾„ | ../scripts/mixcr.jar |
| Use C Version | ä½¿ç”¨Cç‰ˆæœ¬åŠ é€Ÿ | False |
| Force Restart | å¼ºåˆ¶é‡æ–°å¼€å§‹ | False |

## ç›®å½•ç»“æ„

```
web/
â”œâ”€â”€ app.py              # ä¸»Flaskåº”ç”¨
â”œâ”€â”€ pipeline_runner.py  # Webç‰ˆæœ¬çš„æµç¨‹è¿è¡Œå™¨
â”œâ”€â”€ start_server.py     # æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–
â”œâ”€â”€ README.md           # æœ¬æ–‡æ¡£
â”œâ”€â”€ templates/          # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ index.html      # ä¸»é¡µé¢
â”‚   â””â”€â”€ job.html        # ä»»åŠ¡ç›‘æ§é¡µé¢
â”œâ”€â”€ static/             # é™æ€æ–‡ä»¶ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â””â”€â”€ results/            # ç»“æœæ–‡ä»¶ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
```

## æŠ€æœ¯æ¶æ„

- **åç«¯**: Flask + Flask-SocketIO
- **å‰ç«¯**: Bootstrap 5 + Vanilla JavaScript
- **å®æ—¶é€šä¿¡**: WebSocket (Socket.IO)
- **ä»»åŠ¡ç®¡ç†**: Python threading
- **æ–‡ä»¶å¤„ç†**: è‡ªåŠ¨ZIPå‹ç¼©

## å‘½ä»¤è¡Œé€‰é¡¹

å¯åŠ¨æœåŠ¡å™¨æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹ï¼š

```bash
python start_server.py [é€‰é¡¹]

é€‰é¡¹:
  --host HOST       ç»‘å®šä¸»æœºåœ°å€ (é»˜è®¤: 0.0.0.0)
  --port PORT       ç«¯å£å· (é»˜è®¤: 5000)
  --debug           è°ƒè¯•æ¨¡å¼
  --check-only      ä»…æ£€æŸ¥ä¾èµ–ï¼Œä¸å¯åŠ¨æœåŠ¡å™¨
```

## ç”Ÿäº§éƒ¨ç½²

### ä½¿ç”¨Gunicorn

```bash
pip install gunicorn
gunicorn --worker-class eventlet -w 1 --bind 0.0.0.0:5000 app:app
```

### ä½¿ç”¨Nginxåå‘ä»£ç†

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /socket.io/ {
        proxy_pass http://127.0.0.1:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   python start_server.py --port 8080
   ```

2. **ç¼ºå°‘ä¾èµ–åŒ…**
   ```bash
   pip install -r requirements.txt
   ```

3. **æ— æ³•æ‰¾åˆ°MiXCR**
   - æ£€æŸ¥MiXCR JARæ–‡ä»¶è·¯å¾„
   - ç¡®ä¿æ–‡ä»¶æƒé™æ­£ç¡®

4. **Cç‰ˆæœ¬æ— æ³•ä½¿ç”¨**
   - ç¡®ä¿å·²ç¼–è¯‘Cç¨‹åº
   - æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶æƒé™

### æ—¥å¿—è°ƒè¯•

å¯ç”¨è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š

```bash
python start_server.py --debug
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦**: æ­¤Webç•Œé¢ä¸»è¦ç”¨äºå†…ç½‘ç¯å¢ƒï¼Œå¦‚éœ€å…¬ç½‘éƒ¨ç½²è¯·æ³¨æ„ï¼š

1. æ·»åŠ ç”¨æˆ·è®¤è¯æœºåˆ¶
2. é™åˆ¶æ–‡ä»¶è®¿é—®æƒé™  
3. ä½¿ç”¨HTTPSåè®®
4. é…ç½®é˜²ç«å¢™è§„åˆ™

## è®¸å¯è¯

æœ¬é¡¹ç›®ç»§æ‰¿PairTCRçš„è®¸å¯è¯æ¡æ¬¾ã€‚ 